<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hướng dẫn nạp Firmware module bluetooth RN-42 lên HC-05 (HC-06) | LamLogs</title>
    <meta name="description" content="Log&#39;s anything">
    
    
    <link rel="preload" href="/assets/css/0.styles.17f32d1e.css" as="style"><link rel="preload" href="/assets/js/app.c3b7c968.js" as="script"><link rel="preload" href="/assets/js/2.243e2cc0.js" as="script"><link rel="preload" href="/assets/js/10.34aa2e39.js" as="script"><link rel="prefetch" href="/assets/js/11.bcb96f38.js"><link rel="prefetch" href="/assets/js/3.5ecd6063.js"><link rel="prefetch" href="/assets/js/4.b7a9ba0c.js"><link rel="prefetch" href="/assets/js/5.f8b1dd83.js"><link rel="prefetch" href="/assets/js/6.db09eb46.js"><link rel="prefetch" href="/assets/js/7.a5f79b38.js"><link rel="prefetch" href="/assets/js/8.8b5a0052.js"><link rel="prefetch" href="/assets/js/9.5bc8e697.js">
    <link rel="stylesheet" href="/assets/css/0.styles.17f32d1e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="./assets/img/logo.png" alt="LamLogs" class="logo"> <span class="site-name can-hide">LamLogs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Trang Chủ</a></div><div class="nav-item"><a href="/about/" class="nav-link">Giới Thiệu</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Trang Chủ</a></div><div class="nav-item"><a href="/about/" class="nav-link">Giới Thiệu</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Hướng dẫn nạp Firmware module bluetooth RN-42 lên HC-05 (HC-06)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/posts/2019-12-23-rn42.html#muc-dich" class="sidebar-link">Mục đích</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/posts/2019-12-23-rn42.html#thiet-bi-can-thiet" class="sidebar-link">Thiết bị cần thiết</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/posts/2019-12-23-rn42.html#phan-mem-can-thiet" class="sidebar-link">Phần mềm cần thiết</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/posts/2019-12-23-rn42.html#trien-khai" class="sidebar-link">Triển khai</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/posts/2019-12-23-rn42.html#_1-so-do-chan" class="sidebar-link">1. Sơ đồ chân</a></li><li class="sidebar-sub-header"><a href="/posts/2019-12-23-rn42.html#_2-mach-minh-hoa" class="sidebar-link">2. Mạch minh hoạ</a></li><li class="sidebar-sub-header"><a href="/posts/2019-12-23-rn42.html#_3-ket-noi-ft232-vao-pc" class="sidebar-link">3. Kết nối FT232 vào PC</a></li><li class="sidebar-sub-header"><a href="/posts/2019-12-23-rn42.html#_4-noi-hc-05-voi-mach-nap" class="sidebar-link">4. Nối HC-05 với mạch nạp</a></li><li class="sidebar-sub-header"><a href="/posts/2019-12-23-rn42.html#_5-backup-lai-fw-hc05-va-mot-so-thu-quan-trong" class="sidebar-link">5. Backup lại FW HC05 và một số thứ quan trọng</a></li><li class="sidebar-sub-header"><a href="/posts/2019-12-23-rn42.html#_6-nap-firmware-rn-42-len-hc05-buoc-hap-dan-da-cho-doi-chuan-bi-nay-gio" class="sidebar-link">6. Nạp Firmware RN-42 lên HC05 (bước hấp dẫn đã chờ đợi chuẩn bị nãy giờ)</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="muc-dich"><a href="#muc-dich" class="header-anchor">#</a> Mục đích</h2> <ul><li>Mục đích: RN-42 có thêm một số tính năng, như mình cần thêm HID – giả lập bàn phím bluetooth.</li> <li>RN-42, HC-05(HC-06) dùng chip cơ bản là tương tự nhau, những phần khác nhau chi tiết thì mình chưa tìm hiểu.</li> <li>Lưu ý: Các bạn làm theo từng bước cẩn thận, mình không chịu trách nhiệm cho mọi rủi ro có thể xảy ra (HC-05 3$ convert to RN-42 20$ - if you know I mean), có vấn đề gì thắc mắc các bạn comment phía bên dưới nhé.</li></ul> <h2 id="thiet-bi-can-thiet"><a href="#thiet-bi-can-thiet" class="header-anchor">#</a> <strong>Thiết bị cần thiết</strong></h2> <ol><li>Mạch Bluetooth HC-05 (HC06 mình chưa thử nhưng cơ bản là 2 con này giống nhau, chỉ khác nhau phần sử dụng chân)<img src="https://daocode.files.wordpress.com/2016/11/hc05_1.jpg" alt="hc05_1"></li> <li>Mạch nạp FT232RL – sử dụng chip FTDI<img src="https://daocode.files.wordpress.com/2016/11/ft232rl_1.jpg" alt="ft232rl_1"></li> <li>4 điện trở 100ohm</li> <li>Nguồn phụ 3,3V khoảng trên 100mA – mình dùng nguồn trên con Arduino Uno luôn</li></ol> <h2 id="phan-mem-can-thiet"><a href="#phan-mem-can-thiet" class="header-anchor">#</a> <strong>Phần mềm cần thiết</strong></h2> <ol><li><a href="http://zadig.akeo.ie/" target="_blank" rel="noopener noreferrer">Zadig<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.csrsupport.com/login.php?returnto=/PCSW" target="_blank" rel="noopener noreferrer">Blueflash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> – cái này bạn cần lên trang chủ đăng ký một tài khoản free để download về, vì mỗi người có 1 mã riêng, mình share có thể bị lỗi bản quyền, các bạn thông cảm.</li> <li>Sau khi cài đặt Blueflash, các bạn vào <a href="https://github.com/lorf/csr-spi-ftdi/releases" target="_blank" rel="noopener noreferrer">https://github.com/lorf/csr-spi-ftdi/releases<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> để lấy file ‘<em>dll’</em> trong folder ‘<em>lib-win32’</em> copy đè (nên copy đi đâu đó hoặc rename) vào thư mục (C:\Program Files (x86)\CSR\BlueSuite 2.6.2) win64 bit hoặc (C:\Program Files\CSR\BlueSuite 2.6.2).</li> <li><a href="https://drive.google.com/file/d/0B2oHzSfiLL8PdU1tWmhvS19EWG8/view?usp=sharing" target="_blank" rel="noopener noreferrer">Firmware RN-42<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol> <h2 id="trien-khai"><a href="#trien-khai" class="header-anchor">#</a> Triển khai</h2> <h3 id="_1-so-do-chan"><a href="#_1-so-do-chan" class="header-anchor">#</a> 1. Sơ đồ chân</h3> <p>Đây là sơ đồ chân của HC-05 (module nhỏ nằm phía trên) <img src="https://daocode.files.wordpress.com/2016/11/hc05_pinout.jpg" alt="hc05_pinout"></p> <h3 id="_2-mach-minh-hoa"><a href="#_2-mach-minh-hoa" class="header-anchor">#</a> 2. Mạch minh hoạ</h3> <p>Các bạn đi chân (CLK, MISO, MOSI, CSB) cho HC-05 như hình bên dưới (chân VCC và GND có thể sử dụng chân đã có săn ở bên ngoài)<img src="https://daocode.files.wordpress.com/2016/11/hc05_2.jpg" alt="hc05_2"></p> <h3 id="_3-ket-noi-ft232-vao-pc"><a href="#_3-ket-noi-ft232-vao-pc" class="header-anchor">#</a> 3. Kết nối FT232 vào PC</h3> <p>Kết nối mạch nạp FT232 vào PC, mở Zadig lên chọn (FT232R USB UART, libusbK(v3.0.7.0)) sau đó bấm Replace Driver như hình<img src="https://daocode.files.wordpress.com/2016/11/zadig.png" alt="zadig"></p> <h3 id="_4-noi-hc-05-voi-mach-nap"><a href="#_4-noi-hc-05-voi-mach-nap" class="header-anchor">#</a> 4. Nối HC-05 với mạch nạp</h3> <p>Rút mạch nạp ra khỏi PC, nối HC-05 với mạch nạp (thông qua các điện trở 100ohm) như sau (hình bên dưới)</p> <ol><li>CLK -&gt; RTS</li> <li>MISO -&gt; DSR</li> <li>MOSI -&gt; RI</li> <li>CSB -&gt; DTR</li></ol> <ul><li>Nối thêm vcc 3.3V của nguồn phụ vào vcc của HC05</li> <li>GND nối chung 3 cái nguồn phụ, mạch nạp và HC05</li></ul> <p><img src="https://daocode.files.wordpress.com/2016/11/hc05_3.jpg" alt="hc05_3"></p> <h3 id="_5-backup-lai-fw-hc05-va-mot-so-thu-quan-trong"><a href="#_5-backup-lai-fw-hc05-va-mot-so-thu-quan-trong" class="header-anchor">#</a> 5. Backup lại FW HC05 và một số thứ quan trọng</h3> <p><span style="color:#ff0000;"><u>Lưu ý nên chạy chế độ Run as Adminstrator cho các chương trình.</u></span></p> <ol><li>Kết nối mạch nạp vào PC</li> <li>Mở Blueflash lên (chờ một chút để chương trình hiện nút Stop Processor), bấm Stop Processor</li> <li>Lưu FW hiện tại trong HC05, Bấm Dump, ta được 2 file (.xpv và .xdv)</li> <li>Sau đó bấm Start process lại</li> <li>Lưu các thông số quan trọng của module, mở BlueCore Persistent Store (<em>PStool</em>.<em>exe</em>), chọn <u>F</u>ile -&gt; Save (export), ta được file (.psr) tạm đặt là ‘HC05.psr’</li> <li>Copy lại 1 file (HC05_backup.psr), edit ‘HC05.psr’ chỉ cần giữ lại 3 thông số:
<ul><li>// PSKEY_BDADDR
<ul><li>&amp;0001 = …</li></ul></li> <li>// PSKEY_ANA_FTRIM
<ul><li>&amp;01f6 = …</li></ul></li> <li>// PSKEY_ANA_FREQ
<ul><li>&amp;01fe = …</li></ul></li></ul></li></ol> <p>Lưu lại.</p> <h3 id="_6-nap-firmware-rn-42-len-hc05-buoc-hap-dan-da-cho-doi-chuan-bi-nay-gio"><a href="#_6-nap-firmware-rn-42-len-hc05-buoc-hap-dan-da-cho-doi-chuan-bi-nay-gio" class="header-anchor">#</a> 6. Nạp Firmware RN-42 lên HC05 (bước hấp dẫn đã chờ đợi chuẩn bị nãy giờ)</h3> <ol><li>Trên Blueflash, Bấm Download, chọn file firmware của RN-42 đã tải về.Chờ 1 chút để chương trình upload lên HC05</li> <li>Tắt Blueflash đi để trách truy xuất 2 chương trình vào 1 lúc vào mạch nạp, Mở Pstool.exe lên, chọn ‘Merge’ trong menu File, chọn file ‘HC05.psr’ đã được edit ở trên để nạp lại thông số cũ của module (nếu không sẽ không giao tiếp được).</li></ol> <ul><li><em>Giải thích: ví dụ như thông số BDADDR là địa chỉ bluetooth của nhà sản xuất, mỗi module sẽ có một địa chỉ riêng, có thể lấy thông số của module HC05 khác nhưng sẽ bị trùng địa chỉ, vẫn có thể sử dụng được với các thiết bị khác nhưng không biết sẽ như thế nào nếu 2 thiết bị đó pair với nhau hoặc 2 thiết bị cùng pair với thiết bị khác.</em></li></ul> <p>Congratulation!!, nếu đã tới đây, chúc mừng bạn đã nạp được fw của RN42 cho HC05 của mình. Bạn có thể nạp các chương trình Arduino tương tác với RN42 cho HC05 rồi đấy. Bài sau mình sẽ ví dụ về giả lập bàn phím bluetooth trên HC05. Có thắc mắc gì các bạn cứ comment mục bình luận bên dưới hoặc có thể pm fb cho mình. Cảm ơn các bạn.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c3b7c968.js" defer></script><script src="/assets/js/2.243e2cc0.js" defer></script><script src="/assets/js/10.34aa2e39.js" defer></script>
  </body>
</html>
